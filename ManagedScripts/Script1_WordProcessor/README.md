# Word Processor Script

## Описание
Word Processor - это скрипт AutoHotkey для автоматизированной обработки слов из текстового файла. Скрипт считывает слова из файла `words.txt`, обрабатывает их и перемещает в файл `used_words.txt`. Приложение поддерживает логирование, настройку параметров и межпроцессное взаимодействие (IPC) для интеграции с другими скриптами.

## Требования
- AutoHotkey v2.0 или выше
- Windows 7/8/10/11

## Установка
1. Скопируйте все файлы в выбранную директорию
2. Убедитесь, что структура файлов сохранена:
   ```
   ManagedScripts/Script1_WordProcessor/
   ├── Main.ahk                 # Главный файл приложения
   ├── WordProcessor.ahk        # Основной модуль обработки слов
   ├── FileManager.ahk          # Модуль для работы с файлами
   ├── ConfigManager.ahk        # Модуль для работы с настройками
   ├── Logger.ahk               # Модуль для логирования
   ├── UIHelper.ahk             # Модуль для работы с интерфейсом
   ├── HotkeyManager.ahk        # Модуль для управления горячими клавишами
   ├── VersionManager.ahk       # Модуль для управления версиями
   ├── settings.ini             # Файл настроек (создается автоматически)
   ├── README.md                # Этот файл
   ├── IPC/                     # Директория с модулями для IPC
   │   ├── CommandDefinitions.ahk  # Определения команд IPC
   │   ├── CommandHandler.ahk      # Обработчик команд IPC
   │   ├── IPCConfig.ahk           # Конфигурация IPC
   │   ├── IPCListener.ahk         # Слушатель IPC сообщений
   │   ├── IPCProtocol.ahk         # Протокол IPC
   │   ├── JSONHelper.ahk          # Вспомогательный класс для работы с JSON
   │   └── StatusReporter.ahk       # Репортер статуса для IPC
   ```

## Использование
1. Создайте файл `words.txt` в той же директории, что и скрипт, и добавьте в него слова (по одному слову на строку)
2. Запустите `Main.ahk`
3. Используйте следующие горячие клавиши:
   - **F1**: Начать обработку слов
   - **F2**: Восстановить файлы (переместить слова из `used_words.txt` обратно в `words.txt`)
   - **F3**: Показать справку
   - **Escape**: Выйти из приложения

## Настройка
При первом запуске скрипт создаст файл `settings.ini` со следующими параметрами:

```ini
[General]
MinDelay=1000       ; Минимальная задержка между обработкой слов (мс)
MaxDelay=3000       ; Максимальная задержка между обработкой слов (мс)
LogFile=log.txt     ; Файл для общего логирования
ErrorLogFile=error_log.txt  ; Файл для логирования ошибок
StatsFile=stats.txt        ; Файл для логирования статистики
```

Вы можете изменить эти параметры вручную или через интерфейс приложения.

## Межпроцессное взаимодействие (IPC)
Скрипт поддерживает межпроцессное взаимодействие для интеграции с другими скриптами. При первом запуске создается файл `ipc_settings.ini` со следующими параметрами:

```ini
[General]
IPCEnabled=0                    ; Включение/выключение IPC (0 - выключено, 1 - включено)
MainControllerName=MainController.ahk  ; Имя главного контроллера
StatusReportInterval=5000       ; Интервал отправки статуса (мс)
```

Для включения IPC установите `IPCEnabled=1` и перезапустите скрипт.

### Поддерживаемые IPC команды
- `SHUTDOWN`: Завершение работы скрипта
- `GET_STATUS`: Получение текущего статуса
- `START_PROCESSING`: Начало обработки слов
- `STOP_PROCESSING`: Остановка обработки слов
- `RESTORE_FILES`: Восстановление файлов
- `GET_STATS`: Получение статистики

## Логирование
Скрипт ведет логи в следующих файлах:
- `log.txt`: Общий лог
- `error_log.txt`: Лог ошибок
- `stats.txt`: Статистика обработки
- `critical_errors.log`: Критические ошибки (создается только при возникновении критических ошибок)

## Устранение неполадок
1. **Скрипт не запускается**: Убедитесь, что установлен AutoHotkey v2.0 или выше
2. **Ошибка при обработке слов**: Проверьте наличие файла `words.txt` и права доступа к нему
3. **Проблемы с IPC**: Проверьте настройки в `ipc_settings.ini` и убедитесь, что главный контроллер запущен

## Лицензия
Свободное использование и распространение

## Версия
1.0.0 (2025-01-07)